<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Romantic WOW</title>
  <style>
    :root{ --bg:#090b14; --text:#e9eef5; --muted:#aab3c5 }
    html,body{ height:100%; margin:0; background:var(--bg); color:var(--text); font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif; overflow:hidden }
    #stage{ position:fixed; inset:0 }
    .title{ position:fixed; left:50%; top:14%; transform:translateX(-50%); font-size:clamp(28px,5vw,64px); text-align:center;
            text-shadow:0 0 30px rgba(255,130,200,.35) }
    .sub{ position:fixed; left:50%; top:24%; transform:translateX(-50%); color:var(--muted) }
    .controls{ position:fixed; left:50%; bottom:24px; transform:translateX(-50%); display:flex; gap:10px }
    .btn{ padding:10px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.15); background:rgba(0,0,0,.35); color:#fff; text-decoration:none }
  </style>
</head>
<body>
  <canvas id="stage"></canvas>
  <div class="title">For {{ display_name }} ðŸ’–</div>
  <div class="sub">Turn up your volume a tiny bit.</div>
  <div class="controls">
    <button id="music" class="btn">Play Music ðŸŽ¶</button>
    <a href="{{ url_for('secret') }}" class="btn">A secretâ€¦ ðŸ’Œ</a>
  </div>

<script>
const C = document.getElementById('stage');
const X = C.getContext('2d');
function size(){ C.width=innerWidth; C.height=innerHeight } size(); addEventListener('resize', size);

const hearts=[];
function spawnHeart(){
  const x = Math.random()*C.width, y = C.height+20;
  const s = 12 + Math.random()*24;
  hearts.push({x,y,s,vy:-(.6+Math.random()*1.2),vx:(Math.random()-.5)*.5,rot:Math.random()*Math.PI});
}
setInterval(spawnHeart, 120);
function heartPath(ctx,s){ ctx.moveTo(0,-s*.2); ctx.bezierCurveTo(s*.7,-s, s*1.4, -s*.1, 0, s); ctx.bezierCurveTo(-s*1.4,-s*.1, -s*.7,-s, 0,-s*.2); }

function loop(){
  requestAnimationFrame(loop);
  X.clearRect(0,0,C.width,C.height);
  for(const h of hearts){
    h.x+=h.vx; h.y+=h.vy; h.rot+=0.01;
    X.save(); X.translate(h.x,h.y); X.rotate(h.rot);
    X.globalAlpha=0.8; X.fillStyle='hsl('+(330+Math.random()*20)+' 85% 65%)';
    X.beginPath(); heartPath(X,h.s); X.fill(); X.restore();
  }
}
loop();

// soft music (user gesture required)
let started=false;
document.getElementById('music').addEventListener('click', async ()=>{
  if (started) return;
  started=true;
  const AC = window.AudioContext||window.webkitAudioContext;
  const ac = new AC();
  // tiny synth: chord pad
  function tone(freq, t0, len){
    const o = ac.createOscillator(); const g = ac.createGain();
    o.type='sine'; o.frequency.value=freq;
    g.gain.setValueAtTime(0, t0);
    g.gain.linearRampToValueAtTime(0.12, t0+0.8);
    g.gain.exponentialRampToValueAtTime(0.0001, t0+len);
    o.connect(g).connect(ac.destination);
    o.start(t0); o.stop(t0+len);
  }
  const now = ac.currentTime;
  const base = 261.63; // C4
  const chord = [base, base*1.25, base*1.5, base*2];
  for(let i=0;i<6;i++){
    const t = now + i*3.2;
    chord.forEach((f,idx)=> tone(f*(idx?1:0.5), t, 3.0));
  }
});
</script>
</body>
</html>
